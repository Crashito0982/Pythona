import pandas as pd
from pathlib import Path

# Ruta del archivo de prueba: elegí uno que sepas que tiene saldo distinto de 0
ruta = Path("/home/leonardd/Plexus/PROSEGUR/ASU/EC_BULTOS_ATM_ASU_2025-11-12.xlsx")

# Leemos sin encabezados, todo como texto
df = pd.read_excel(ruta, sheet_name=0, header=None, dtype=str).fillna("")

# 1) Ver todas las filas que contengan la palabra "SALDO" (por si viene cortado "SALDO" / "ANTERIOR")
mask = df.apply(
    lambda row: row.astype(str).str.contains("SALDO", case=False, na=False).any(),
    axis=1
)
df_saldo = df[mask]

print("Filas con 'SALDO':")
print(df_saldo)

# 2) Imprimir cada fila como lista para ver EXACTAMENTE cómo vienen las celdas
print("\nDetalle de filas con 'SALDO':")
for idx, row in df_saldo.iterrows():
    print("Fila", idx, "->", [repr(str(x)) for x in row.tolist()])
